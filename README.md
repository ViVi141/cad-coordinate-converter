# CAD坐标转换器

**版本**: 1.4.0
**作者**: ViVi141 ([747384120@qq.com](mailto:747384120@qq.com))

## 概述

CAD坐标转换器是一个桌面 GUI 程序，旨在将 TXT 格式的坐标数据转换为 CAD 图形绘制命令。它支持 Windows 7/8/10/11 系统，并提供图形预览功能（需要安装 matplotlib）。

## 更新记录

### v1.4.0 (2025-07-29)
**重大修复和优化**
- **修复CAD命令终止符问题**：
  - 多段线命令：封闭图形使用 `C` 终止符，开放图形使用 `C^` 终止符
  - 直线命令：添加空行结束line命令组
  - 点命令：添加空行结束point命令组
  - ~~文字命令：添加空行结束text命令组~~ (当前版本已暂时禁用)
- **彻底修复分组连接问题**：
  - 解决ABC三个封闭图形之间的跨组连接问题
  - 确保每个封闭图形独立生成CAD命令
  - 修复A的最后一个点连接到B的第一个点的问题
- **优化坐标解析**：
  - 支持科学记数法坐标格式
  - 支持负数坐标
  - 添加坐标值合理性验证
  - 改进正则表达式匹配精度
- **性能优化**：
  - 大文件流式处理，避免内存溢出
  - 改进matplotlib资源清理
  - 添加处理进度状态更新
- **修复CAD命令格式**：
  - LINE命令：修正为连接相邻点的正确格式
  - PLINE命令：改进为多行格式，支持自动闭合
  - TEXT命令：修正参数顺序和字符串引用



## 功能

- **坐标转换**: 将 TXT 文件中的坐标数据转换为 CAD 命令（支持多段线、直线和点）。
- **图形预览**: 如果安装了 matplotlib，可以预览坐标数据的图形表示。
- **分组处理**: 支持按分组处理坐标数据，生成独立的 CAD 命令，避免跨组连接。
- **文字标注**: ~~可选择在 CAD 命令中添加文字标注。~~ (当前版本已暂时禁用)
- **自动复制**: 转换后自动将 CAD 命令复制到剪贴板。
- **大文件支持**: 支持流式处理大文件，避免内存溢出。
- **科学记数法**: 支持科学记数法格式的坐标数据。
- **UTF-8编码**: 支持UTF-8编码的TXT文件。
- **CAD标准兼容**: 所有生成的CAD命令都符合CAD软件标准。

## 安装

1. **运行程序**: 下载并运行 `dist` 目录中的 `CAD坐标转换器.exe` 文件。
2. **依赖项**: 如果需要图形预览功能，请确保安装了 matplotlib 和 numpy。您可以使用提供的 `requirements.txt` 文件通过以下命令安装依赖项：
   ```
   pip install -r requirements.txt
   ```

## 使用说明

1. 启动 `CAD坐标转换器.exe`。
2. 选择包含坐标数据的 TXT 文件（UTF-8编码）。
3. 选择转换类型（多段线、直线或点）。
4. 设置是否按分组处理。
5. 点击“开始转换”按钮。
6. 转换后的 CAD 命令将显示在界面中，并可自动复制到剪贴板。

## 快捷键

- **Ctrl+O**: 打开坐标文件
- **Ctrl+Enter**: 执行坐标转换
- **Ctrl+C**: 复制 CAD 命令到剪贴板
- **Ctrl+S**: 保存结果到文件
- **Ctrl+L**: 清空结果显示
- **F1**: 显示帮助信息

## 支持的坐标格式

- **X,Y 坐标**: 例如 `447677.9778, 2491585.3947`
- **X,Y,Z 坐标**: 例如 `447677.9778, 2491585.3947, 100.5`
- **科学记数法**: 例如 `4.476779778e+05, 2.4915853947e+06`
- **负数坐标**: 例如 `-447677.9778, -2491585.3947`
- **分组标识**: 例如 `第1组`、`第2组`、`A封闭图形`、`B封闭图形`

## 注意事项

- 程序在 Win7 中运行时，按钮文本已调整为普通文本，以确保正确显示。
- 控制台窗口已隐藏，程序运行时不会显示命令行界面。
- 窗口图标设置为 `favicon.ico`，确保在所有支持的 Windows 版本中正确显示。
- 大文件处理时会显示进度提示，建议耐心等待。
- 分组处理模式下，每个封闭图形会独立生成CAD命令，避免跨组连接。
- 所有CAD命令都使用标准终止符，确保在CAD软件中正确执行。
- 坐标文件必须使用UTF-8编码格式，否则可能导致读取失败。

## 联系方式

如有任何问题或建议，请联系作者 ViVi141 ([747384120@qq.com](mailto:747384120@qq.com))。 