# CAD坐标转换器 v1.1.0

## 📋 项目简介

CAD坐标转换器是一个专业的坐标数据转换工具，能够将TXT格式的坐标数据转换为CAD可识别的命令格式，支持多段线(pline)、直线(line)和点(point)的生成。

## ✨ v1.1.0 新功能

### 🚀 重大功能更新

#### 1. **自动复制到CAD功能**
- **新增**: 自动复制功能，支持一键将生成的CAD命令直接粘贴到CAD软件
- **智能检测**: 自动检测是否安装了pyautogui库
- **安全机制**: 包含详细的风险警告和操作说明
- **进度反馈**: 实时显示复制进度和完成状态

#### 2. **分组多段线处理优化**
- **问题解决**: 修复了分组多段线在CAD中被合并为单一多段线的问题
- **命令分离**: 通过模拟键盘操作确保每个分组的多段线独立执行
- **格式优化**: 改进了CAD命令格式，确保命令正确执行

#### 3. **模拟键盘操作**
- **技术实现**: 使用pyautogui库实现键盘模拟
- **命令执行**: 自动粘贴命令并按回车键执行
- **资源管理**: 完善的资源清理机制，避免内存泄漏
- **错误处理**: 完善的异常处理和错误恢复机制

### 🎯 用户体验改进

#### 4. **界面优化**
- **自适应窗口**: 移除了固定窗口大小设置，支持自适应布局
- **对话框改进**: 所有对话框采用自适应大小，保持居中显示
- **按钮优化**: 改进了按钮布局和图标显示

#### 5. **复制方式选择**
- **多种选择**: 提供三种复制方式选择
  - 复制全部组
  - 选择特定组
  - 预览后复制
- **智能提示**: 详细的复制方式说明和操作指导

#### 6. **警告和提示系统**
- **详细警告**: 自动复制功能的详细风险说明
- **操作指导**: 清晰的操作步骤和安全建议
- **完成提示**: 操作完成后的统计信息和结果展示

### 🔧 技术改进

#### 7. **命令生成优化**
- **精度统一**: 统一坐标精度为4位小数
- **格式标准化**: 使用更标准的CAD多段线命令格式
- **空行处理**: 优化了命令间的空行处理

#### 8. **资源管理**
- **内存优化**: 完善的资源清理机制
- **性能提升**: 减少了不必要的延迟和资源占用
- **垃圾回收**: 强制垃圾回收，避免内存泄漏

#### 9. **错误处理**
- **异常捕获**: 完善的异常处理机制
- **错误恢复**: 自动错误恢复和资源清理
- **用户反馈**: 详细的错误信息和解决建议

### 📦 依赖更新

#### 10. **新增依赖**
```txt
pyautogui>=0.9.53
pillow>=8.0.0
mouseinfo>=0.1.3
pygetwindow>=0.0.9
```

## 🛠️ 安装说明

### 环境要求
- Python 3.7+
- Windows 10/11

### 安装步骤

1. **克隆项目**
```bash
git clone [项目地址]
cd CAD坐标转换器
```

2. **创建虚拟环境**
```bash
python -m venv venv
venv\Scripts\activate
```

3. **安装依赖**
```bash
pip install -r requirements.txt
```

4. **运行程序**
```bash
python CAD坐标转换器.py
```

## 📖 使用说明

### 基本操作

1. **加载坐标文件**
   - 点击"浏览文件"选择TXT格式的坐标文件
   - 支持X,Y和X,Y,Z格式的坐标数据
   - 支持分组标识（如"第1组"）

2. **选择转换类型**
   - 多段线(pline): 生成连续的多段线
   - 直线(line): 生成独立的直线段
   - 点(point): 生成独立的点

3. **转换坐标**
   - 点击"转换坐标"按钮
   - 查看生成的CAD命令
   - 可选择是否自动复制到CAD

### 高级功能

#### 自动复制到CAD
1. **启用自动复制**: 在转换选项中勾选"自动复制"
2. **选择复制方式**: 
   - 复制全部组
   - 选择特定组
   - 预览后复制
3. **确认操作**: 阅读警告信息并确认操作
4. **等待完成**: 程序会自动执行复制操作

#### 分组处理
- **自动识别**: 程序自动识别坐标文件中的分组标识
- **独立处理**: 每个分组生成独立的CAD命令
- **批量操作**: 支持批量复制所有分组或选择特定分组

## ⚠️ 重要说明

### 自动复制功能
- **风险提示**: 自动复制功能会模拟键盘操作，请确保CAD窗口处于活动状态
- **安全建议**: 操作前请保存当前工作，避免意外操作
- **兼容性**: 适用于大多数CAD软件，但建议在测试环境中先验证

### 分组多段线
- **技术限制**: 由于CAD的命令行限制，连续的多段线命令会被合并
- **解决方案**: 使用模拟键盘操作强制分离每个分组的多段线
- **替代方案**: 这是为了克服CAD限制而设计的妥协方案

## 🐛 已知问题

1. **依赖安装**: pyautogui在某些系统上可能需要额外配置
2. **权限问题**: 某些系统可能需要管理员权限运行
3. **兼容性**: 不同版本的CAD软件可能有细微差异

## 🔄 更新日志

### v1.1.0 (2024-12-19)
- ✅ 新增自动复制到CAD功能
- ✅ 修复分组多段线合并问题
- ✅ 添加模拟键盘操作
- ✅ 优化界面布局和用户体验
- ✅ 完善错误处理和资源管理
- ✅ 添加详细的警告和提示系统
- ✅ 统一坐标精度和命令格式
- ✅ 新增多种复制方式选择

### v1.0.0 (初始版本)
- ✅ 基本的坐标转换功能
- ✅ 支持多段线、直线、点生成
- ✅ 图形预览功能
- ✅ 文件保存和加载

## 📞 技术支持

如果您在使用过程中遇到问题，请：
1. 检查是否安装了所有依赖
2. 确认CAD软件版本兼容性
3. 查看错误日志和提示信息
4. 在测试环境中验证功能

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

---

**注意**: v1.1.0版本引入了自动复制功能，这是一个重大更新。建议在使用前仔细阅读相关说明和警告信息。 