# CAD坐标转换器使用手册 v1.1.0
## 非技术人员版

---

## 📖 目录
1. [软件简介](#软件简介)
2. [安装和启动](#安装和启动)
3. [基本操作](#基本操作)
4. [高级功能](#高级功能)
5. [常见问题](#常见问题)
6. [安全提示](#安全提示)

---

## 🎯 软件简介

### 什么是CAD坐标转换器？
CAD坐标转换器是一个专门帮助您将坐标数据转换成CAD绘图命令的工具。简单来说，它就像一个"翻译官"，把您的坐标数据"翻译"成CAD软件能理解的命令。

### 主要功能
- ✅ **坐标转换**: 将TXT文件中的坐标转换成CAD命令
- ✅ **图形预览**: 在转换前预览坐标数据的图形效果
- ✅ **分组处理**: 支持多个图形的分组处理
- ✅ **自动复制**: 一键将命令复制到CAD软件中

### v1.1.0版本新功能
- 🆕 **自动复制到CAD**: 新增一键自动复制功能
- 🆕 **分组多段线优化**: 修复了分组图形合并的问题
- 🆕 **界面优化**: 改进了软件界面，使用更便捷
- 🆕 **安全机制**: 增加了详细的操作提示和警告

---

## 💻 安装和启动

### 系统要求
- **操作系统**: Windows 7 SP1及以上 支持32位及64位
- **内存**: 至少 4GB RAM
- **硬盘空间**: 至少 100MB 可用空间

### 安装步骤

#### 方法一：直接运行（推荐）
1. 下载 `CAD坐标转换器.exe` 文件
2. 双击文件即可运行，无需安装

#### 方法二：Python环境运行
1. 确保电脑已安装Python 3.7或更高版本
2. 下载项目文件
3. 打开命令提示符，进入项目文件夹
4. 运行命令：`python CAD坐标转换器.py`

### 启动软件
1. 双击 `CAD坐标转换器.exe` 文件
2. 等待软件启动（可能需要几秒钟）
3. 看到主界面后即可开始使用

---

## 🔧 基本操作

### 第一步：准备坐标文件

#### 文件格式要求
您的坐标文件必须是 `.txt` 格式，内容格式如下：

**简单坐标格式：**
```
447677.9778, 2491585.3947
447678.1234, 2491586.5678
447679.2345, 2491587.7890
```

**带Z坐标的格式：**
```
447677.9778, 2491585.3947, 100.5
447678.1234, 2491586.5678, 101.2
447679.2345, 2491587.7890, 102.1
```

**分组坐标格式：**
```
第1组
447677.9778, 2491585.3947
447678.1234, 2491586.5678

第2组
447679.2345, 2491587.7890
447680.3456, 2491588.9012
```

#### 注意事项
- 坐标之间用逗号分隔
- 每组坐标之间用空行分隔
- 支持中文分组名称
- 坐标精度建议保留4位小数

### 第二步：加载坐标文件

1. **点击"浏览"按钮**
   - 在软件左侧找到"文件选择"区域
   - 点击"浏览"按钮

2. **选择文件**
   - 在弹出的文件选择窗口中
   - 找到您的坐标文件（.txt格式）
   - 点击"打开"

3. **确认文件加载**
   - 文件路径会显示在输入框中
   - 可以点击"预览文件内容"查看文件内容

### 第三步：设置转换选项

#### 转换类型选择
在"转换选项"区域选择您需要的类型：

- **多段线(pline)**: 生成连续的线条，适合绘制复杂图形
- **直线(line)**: 生成独立的直线段，适合简单图形
- **点(point)**: 生成独立的点，适合标记位置

#### 其他选项
- **添加文字标注**: 勾选后会在每个坐标点添加文字标注
- **按分组处理**: 勾选后会分别处理每个分组
- **自动复制**: 勾选后会自动将结果复制到剪贴板

### 第四步：转换坐标

1. **点击"转换坐标"按钮**
   - 在左侧面板底部找到"转换坐标"按钮
   - 点击开始转换

2. **等待转换完成**
   - 转换过程通常很快（几秒钟）
   - 转换完成后会在右侧显示结果

3. **查看结果**
   - 转换结果会显示在右侧的"CAD命令"区域
   - 可以滚动查看所有生成的命令

### 第五步：使用转换结果

#### 方法一：手动复制粘贴
1. 点击"复制到剪贴板"按钮
2. 打开CAD软件
3. 在CAD中按 `Ctrl+V` 粘贴命令

#### 方法二：保存到文件
1. 点击"保存到文件"按钮
2. 选择保存位置和文件名
3. 点击"保存"
4. 在CAD中打开保存的文件

---

## 🚀 高级功能

### 自动复制到CAD功能

#### 什么是自动复制？
自动复制功能可以帮您直接将生成的CAD命令粘贴到CAD软件中，无需手动复制粘贴。

#### 使用步骤

1. **启用自动复制**
   - 在转换选项中勾选"自动复制"
   - 点击"转换坐标"

2. **选择复制方式**
   软件会弹出选择窗口，提供三种方式：
   - **复制全部组**: 复制所有分组的命令
   - **选择特定组**: 手动选择要复制的分组
   - **预览后复制**: 先预览再决定是否复制

3. **确认操作**
   - 阅读警告信息
   - 点击"确认"继续操作

4. **等待完成**
   - 软件会自动执行复制操作
   - 完成后会显示统计信息

#### 重要提醒
- ⚠️ **操作前请保存CAD中的工作**
- ⚠️ **确保CAD窗口处于活动状态**
- ⚠️ **不要移动鼠标或键盘，避免干扰操作**

### 分组处理功能

#### 什么是分组处理？
分组处理允许您将多个图形分别处理，每个分组生成独立的CAD命令。

#### 使用步骤

1. **准备分组数据**
   ```
   第1组
   100, 200
   200, 300
   300, 400

   第2组
   400, 500
   500, 600
   600, 700
   ```

2. **启用分组处理**
   - 勾选"按分组处理"选项
   - 点击"转换坐标"

3. **选择处理方式**
   - 可以选择处理所有分组
   - 也可以选择特定的分组

### 图形预览功能

#### 什么是图形预览？
图形预览功能可以在转换前查看坐标数据的图形效果，帮助您确认数据是否正确。

#### 使用步骤

1. **加载坐标文件**
   - 按照基本操作步骤加载文件

2. **查看预览**
   - 转换完成后，在右侧会显示图形预览
   - 可以查看2D或3D图形效果

3. **调整显示**
   - 可以缩放、平移查看图形
   - 支持鼠标交互操作

---

## ❓ 常见问题

### Q1: 软件无法启动怎么办？
**A**: 请检查以下几点：
- 确保系统是Windows 7 SP1及以上，支持32位及64位
- 检查是否有杀毒软件阻止运行
- 尝试以管理员身份运行

### Q2: 坐标文件加载失败怎么办？
**A**: 请检查文件格式：
- 确保文件是.txt格式
- 检查坐标格式是否正确
- 确保文件编码是UTF-8

### Q3: 转换结果在CAD中不显示怎么办？
**A**: 请尝试以下方法：
- 检查CAD软件是否支持该命令格式
- 尝试手动复制粘贴
- 检查CAD的坐标系统设置

### Q4: 自动复制功能不工作怎么办？
**A**: 可能的原因：
- 未安装pyautogui库
- CAD窗口未处于活动状态
- 系统权限不足

### Q5: 图形预览不显示怎么办？
**A**: 可能的原因：
- 未安装matplotlib库
- 坐标数据格式错误
- 图形数据为空

### Q6: 分组处理不生效怎么办？
**A**: 请检查：
- 是否勾选了"按分组处理"选项
- 坐标文件中是否有分组标识
- 分组格式是否正确

---

## ⚠️ 安全提示

### 自动复制功能安全提醒

#### 风险说明
- **键盘模拟**: 自动复制功能会模拟键盘操作
- **窗口焦点**: 需要CAD窗口处于活动状态
- **操作不可逆**: 操作过程中请勿移动鼠标或键盘

#### 安全建议
1. **操作前备份**: 在CAD中保存当前工作
2. **测试环境**: 建议先在测试文件中验证功能
3. **关闭其他程序**: 操作时关闭不必要的程序
4. **保持专注**: 操作过程中不要做其他事情

### 数据安全
- **文件备份**: 重要文件请做好备份
- **格式检查**: 转换前检查坐标数据格式
- **结果验证**: 转换后验证结果是否正确

### 系统安全
- **权限管理**: 某些功能可能需要管理员权限
- **防火墙**: 确保防火墙不会阻止软件运行
- **杀毒软件**: 将软件添加到杀毒软件白名单

---

## 📞 技术支持

### 获取帮助
如果您在使用过程中遇到问题，可以：

1. **查看帮助文档**: 按F1键查看详细帮助
2. **检查错误信息**: 查看软件显示的错误提示
3. **联系技术支持**: 发送邮件到 747384120@qq.com

### 反馈建议
我们非常重视您的反馈，如果您有：
- 功能建议
- 使用问题
- 改进意见

请随时联系我们，我们会认真考虑您的建议。

---

## 📝 版本信息

- **当前版本**: v1.1.0
- **发布日期**: 2025年7月24日
- **支持系统**: Windows 7 SP1及以上
- **作者**: ViVi141

---

**感谢您使用CAD坐标转换器！**

如果您觉得这个软件对您有帮助，请推荐给您的同事和朋友。 