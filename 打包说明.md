# CAD坐标转换器 - 打包exe说明

## 概述

本文档说明如何将CAD坐标转换器打包成exe可执行文件，方便在没有Python环境的计算机上运行。

## 打包方式

### 方式一：一键打包（推荐）

1. 双击运行 `打包exe.bat`
2. 脚本会自动检查环境并执行打包
3. 打包完成后，exe文件位于 `dist/CAD坐标转换器_v1.1.0/` 目录

### 方式二：手动打包

1. 确保已安装Python 3.7或更高版本
2. 安装依赖包：`pip install -r requirements.txt`
3. 安装PyInstaller：`pip install pyinstaller`
4. 运行打包脚本：`python 打包exe.py`

## 系统要求

### 开发环境要求
- Windows 7/8/10/11
- Python 3.7或更高版本
- 至少2GB可用内存
- 至少500MB可用磁盘空间

### 运行环境要求
- Windows 7/8/10/11
- 无需安装Python环境
- 支持32位和64位系统

## 依赖包说明

打包过程需要以下Python包：

```
matplotlib>=3.3.0,<3.6.0  # 图形绘制库
numpy>=1.19.0,<1.22.0     # 数值计算库
pyautogui>=0.9.53         # 自动化控制库
pillow>=8.0.0             # 图像处理库
```

## 打包过程详解

### 1. 环境检查
- 检查Python版本（需要3.7+）
- 检查操作系统（主要针对Windows优化）
- 检查PyInstaller是否已安装

### 2. 依赖检查
- 检查matplotlib是否可用
- 检查numpy是否可用
- 检查pyautogui是否可用
- 检查PIL（Pillow）是否可用

### 3. 配置文件生成
自动生成PyInstaller的spec配置文件，包含：
- 主程序文件：`CAD坐标转换器.py`
- 数据文件：图标、手册、说明文档
- 隐藏导入：所有必要的Python模块
- 图标设置：使用favicon.ico

### 4. 执行打包
使用PyInstaller执行打包：
- 清理临时文件
- 不询问覆盖确认
- 使用spec配置文件

### 5. 发布包创建
- 创建标准化的发布目录
- 复制exe文件和所有相关文档
- 生成使用说明文件

## 打包输出

### 目录结构
```
dist/
└── CAD坐标转换器_v1.1.0/
    ├── CAD坐标转换器.exe          # 主程序
    ├── 使用说明.txt               # 使用说明
    ├── CAD坐标转换器使用手册(非技术人员版).md
    ├── CAD坐标转换器使用手册(非技术人员版).pdf
    ├── README.md
    └── LICENSE
```

### 文件说明
- **CAD坐标转换器.exe**: 主程序，无需Python环境即可运行
- **使用说明.txt**: 简化的使用说明
- **CAD坐标转换器使用手册(非技术人员版).md/pdf**: 详细使用手册
- **README.md**: 项目说明文档
- **LICENSE**: 许可证文件

## 常见问题

### Q: 打包失败怎么办？
A: 请检查：
1. Python版本是否为3.7或更高
2. 是否已安装所有依赖包
3. 是否有足够的磁盘空间
4. 是否有管理员权限

### Q: exe文件很大怎么办？
A: 这是正常现象，因为exe包含了完整的Python运行环境和所有依赖库。可以通过以下方式优化：
1. 使用UPX压缩（已启用）
2. 排除不必要的模块
3. 使用虚拟环境减少依赖

### Q: 打包后的程序无法运行？
A: 请检查：
1. 是否在Windows系统上运行
2. 是否有杀毒软件误报
3. 是否缺少系统DLL文件

### Q: 如何减小exe文件大小？
A: 可以尝试：
1. 使用`--onefile`选项（但会增加启动时间）
2. 排除matplotlib的测试文件
3. 使用更精简的依赖版本

## 高级配置

### 自定义spec文件
如果需要自定义打包配置，可以修改`CAD坐标转换器.spec`文件：

```python
# 添加额外的数据文件
datas=[
    ('favicon.ico', '.'),
    ('CAD坐标转换器使用手册(非技术人员版).md', '.'),
    # 添加更多文件...
],

# 添加额外的隐藏导入
hiddenimports=[
    'matplotlib',
    'matplotlib.pyplot',
    # 添加更多模块...
],
```

### 优化选项
- `--onefile`: 打包成单个exe文件
- `--windowed`: 不显示控制台窗口
- `--icon`: 自定义图标
- `--version-file`: 添加版本信息

## 测试验证

打包完成后，建议进行以下测试：

1. **基本功能测试**
   - 程序是否能正常启动
   - 界面是否正常显示
   - 文件选择功能是否正常

2. **转换功能测试**
   - 坐标转换是否正常
   - 图形预览是否正常
   - 复制功能是否正常

3. **兼容性测试**
   - 在不同Windows版本上测试
   - 在32位和64位系统上测试
   - 在没有Python环境的机器上测试

## 发布注意事项

1. **文件完整性**: 确保发布包包含所有必要文件
2. **版本信息**: 更新版本号和日期
3. **文档更新**: 确保使用说明是最新的
4. **病毒扫描**: 在发布前进行病毒扫描
5. **兼容性测试**: 在目标环境中测试

## 技术支持

如果在打包过程中遇到问题，请：

1. 查看控制台输出的错误信息
2. 检查Python和依赖包版本
3. 尝试重新安装依赖包
4. 联系作者获取技术支持

**作者**: ViVi141  
**邮箱**: 747384120@qq.com  
**版本**: 1.1.0 